/* Copyright (c) 2012 HyeonJe Jun (http://github.com/noraesae)
 * Licensed under the MIT License
 */"use strict";(function(e){typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){var t={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0};e.fn.perfectScrollbar=function(n,r){return this.each(function(){var i=e.extend(!0,{},t),s=e(this);typeof n=="object"?e.extend(!0,i,n):r=n;if(r==="update"){s.data("perfect-scrollbar-update")&&s.data("perfect-scrollbar-update")();return s}if(r==="destroy"){s.data("perfect-scrollbar-destroy")&&s.data("perfect-scrollbar-destroy")();return s}if(s.data("perfect-scrollbar"))return s.data("perfect-scrollbar");s.addClass("ps-container");var o=e("<div class='ps-scrollbar-x-rail'></div>").appendTo(s),u=e("<div class='ps-scrollbar-y-rail'></div>").appendTo(s),a=e("<div class='ps-scrollbar-x'></div>").appendTo(o),f=e("<div class='ps-scrollbar-y'></div>").appendTo(u),l,c,h,p,d,v,m,g,y=parseInt(o.css("bottom"),10),b,w,E=parseInt(u.css("right"),10),S=function(){var e=parseInt(w*(v-p)/(p-b),10);s.scrollTop(e);o.css({bottom:y-e})},x=function(){var e=parseInt(g*(d-h)/(h-m),10);s.scrollLeft(e);u.css({right:E-e})},T=function(e){i.minScrollbarLength&&(e=Math.max(e,i.minScrollbarLength));return e},N=function(){o.css({left:s.scrollLeft(),bottom:y-s.scrollTop(),width:h});u.css({top:s.scrollTop(),right:E-s.scrollLeft(),height:p});a.css({left:g,width:m});f.css({top:w,height:b})},C=function(){h=s.width();p=s.height();d=s.prop("scrollWidth");v=s.prop("scrollHeight");if(h<d){l=!0;m=T(parseInt(h*h/d,10));g=parseInt(s.scrollLeft()*(h-m)/(d-h),10)}else{l=!1;m=0;g=0;s.scrollLeft(0)}if(p<v){c=!0;b=T(parseInt(p*p/v,10));w=parseInt(s.scrollTop()*(p-b)/(v-p),10)}else{c=!1;b=0;w=0;s.scrollTop(0)}w>=p-b&&(w=p-b);g>=h-m&&(g=h-m);N()},k=function(e,t){var n=e+t,r=h-m;n<0?g=0:n>r?g=r:g=n;o.css({left:s.scrollLeft()});a.css({left:g})},L=function(e,t){var n=e+t,r=p-b;n<0?w=0:n>r?w=r:w=n;u.css({top:s.scrollTop()});f.css({top:w})},A=function(){var t,n;a.bind("mousedown.perfect-scrollbar",function(e){n=e.pageX;t=a.position().left;o.addClass("in-scrolling");e.stopPropagation();e.preventDefault()});e(document).bind("mousemove.perfect-scrollbar",function(e){if(o.hasClass("in-scrolling")){x();k(t,e.pageX-n);e.stopPropagation();e.preventDefault()}});e(document).bind("mouseup.perfect-scrollbar",function(e){o.hasClass("in-scrolling")&&o.removeClass("in-scrolling")});t=n=null},O=function(){var t,n;f.bind("mousedown.perfect-scrollbar",function(e){n=e.pageY;t=f.position().top;u.addClass("in-scrolling");e.stopPropagation();e.preventDefault()});e(document).bind("mousemove.perfect-scrollbar",function(e){if(u.hasClass("in-scrolling")){S();L(t,e.pageY-n);e.stopPropagation();e.preventDefault()}});e(document).bind("mouseup.perfect-scrollbar",function(e){u.hasClass("in-scrolling")&&u.removeClass("in-scrolling")});t=n=null},M=function(){var e=function(e,t){var n=s.scrollTop();if(n===0&&t>0&&e===0)return!i.wheelPropagation;if(n>=v-p&&t<0&&e===0)return!i.wheelPropagation;var r=s.scrollLeft();return r===0&&e<0&&t===0?!i.wheelPropagation:r>=d-h&&e>0&&t===0?!i.wheelPropagation:!0},t=!1;s.bind("mousewheel.perfect-scrollbar",function(n,r,o,u){if(!i.useBothWheelAxes){s.scrollTop(s.scrollTop()-u*i.wheelSpeed);s.scrollLeft(s.scrollLeft()+o*i.wheelSpeed)}else c&&!l?u?s.scrollTop(s.scrollTop()-u*i.wheelSpeed):s.scrollTop(s.scrollTop()+o*i.wheelSpeed):l&&!c&&(o?s.scrollLeft(s.scrollLeft()+o*i.wheelSpeed):s.scrollLeft(s.scrollLeft()-u*i.wheelSpeed));C();t=e(o,u);t&&n.preventDefault()});s.bind("MozMousePixelScroll.perfect-scrollbar",function(e){t&&e.preventDefault()})},_=function(){var t=function(e,t){var n=s.scrollTop();if(n===0&&t>0&&e===0)return!1;if(n>=v-p&&t<0&&e===0)return!1;var r=s.scrollLeft();return r===0&&e<0&&t===0?!1:r>=d-h&&e>0&&t===0?!1:!0},n=!1;s.bind("mouseenter.perfect-scrollbar",function(e){n=!0});s.bind("mouseleave.perfect-scrollbar",function(e){n=!1});var r=!1;e(document).bind("keydown.perfect-scrollbar",function(e){if(!n)return;var o=0,u=0;switch(e.which){case 37:o=-3;break;case 38:u=3;break;case 39:o=3;break;case 40:u=-3;break;default:return}s.scrollTop(s.scrollTop()-u*i.wheelSpeed);s.scrollLeft(s.scrollLeft()+o*i.wheelSpeed);C();r=t(o,u);r&&e.preventDefault()})},D=function(){var e=function(e){e.stopPropagation()};f.bind("click.perfect-scrollbar",e);u.bind("click.perfect-scrollbar",function(e){var t=parseInt(b/2,10),n=e.pageY-u.offset().top-t,r=p-b,i=n/r;i<0?i=0:i>1&&(i=1);s.scrollTop((v-p)*i);C()});a.bind("click.perfect-scrollbar",e);o.bind("click.perfect-scrollbar",function(e){var t=parseInt(m/2,10),n=e.pageX-o.offset().left-t,r=h-m,i=n/r;i<0?i=0:i>1&&(i=1);s.scrollLeft((d-h)*i);C()})},P=function(){var t=function(e,t){s.scrollTop(s.scrollTop()-t);s.scrollLeft(s.scrollLeft()-e);C()},n={},r=0,i={},o=null,u=!1;e(window).bind("touchstart.perfect-scrollbar",function(e){u=!0});e(window).bind("touchend.perfect-scrollbar",function(e){u=!1});s.bind("touchstart.perfect-scrollbar",function(e){var t=e.originalEvent.targetTouches[0];n.pageX=t.pageX;n.pageY=t.pageY;r=(new Date).getTime();o!==null&&clearInterval(o);e.stopPropagation()});s.bind("touchmove.perfect-scrollbar",function(e){if(!u&&e.originalEvent.targetTouches.length===1){var s=e.originalEvent.targetTouches[0],o={};o.pageX=s.pageX;o.pageY=s.pageY;var a=o.pageX-n.pageX,f=o.pageY-n.pageY;t(a,f);n=o;var l=(new Date).getTime();i.x=a/(l-r);i.y=f/(l-r);r=l;e.preventDefault()}});s.bind("touchend.perfect-scrollbar",function(e){clearInterval(o);o=setInterval(function(){if(Math.abs(i.x)<.01&&Math.abs(i.y)<.01){clearInterval(o);return}t(i.x*30,i.y*30);i.x*=.8;i.y*=.8},10)})},H=function(){s.unbind(".perfect-scrollbar");e(window).unbind(".perfect-scrollbar");e(document).unbind(".perfect-scrollbar");s.data("perfect-scrollbar",null);s.data("perfect-scrollbar-update",null);s.data("perfect-scrollbar-destroy",null);a.remove();f.remove();o.remove();u.remove();a=f=h=p=d=v=m=g=y=b=w=E=null},B=function(t){s.addClass("ie").addClass("ie"+t);var n=function(){var t=function(){e(this).addClass("hover")},n=function(){e(this).removeClass("hover")};s.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",n);o.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",n);u.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",n);a.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",n);f.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",n)},r=function(){N=function(){a.css({left:g+s.scrollLeft(),bottom:y,width:m});f.css({top:w+s.scrollTop(),right:E,height:b});a.hide().show();f.hide().show()};S=function(){var e=parseInt(w*v/p,10);s.scrollTop(e);a.css({bottom:y});a.hide().show()};x=function(){var e=parseInt(g*d/h,10);s.scrollLeft(e);f.hide().show()}};if(t===6){n();r()}},j="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,F=function(){var e=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);e&&e[1]==="msie"&&B(parseInt(e[2],10));C();A();O();D();j&&P();s.mousewheel&&M();i.useKeyboard&&_();s.data("perfect-scrollbar",s);s.data("perfect-scrollbar-update",C);s.data("perfect-scrollbar-destroy",H)};F();return s})}});